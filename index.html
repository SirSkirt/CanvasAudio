<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Audio</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="toolbar">
        <div class="app-logo"><i class="fas fa-layer-group"></i> Canvas Audio</div>
        <div id="version-label" class="version-label"></div>
        
        <div class="btn-group">
            <button id="mode-pat" class="active" onclick="setMode('PATTERN')">PAT</button>
            <button id="mode-song" onclick="setMode('SONG')">SONG</button>
        </div>

        <div class="btn-group">
            <button id="play-btn" onclick="togglePlay()"><i class="fas fa-play"></i></button>
            <button id="stop-btn" onclick="stopTransport()"><i class="fas fa-stop"></i></button>
            <button id="record-btn" onclick="toggleRecord()" title="Record"><i class="fas fa-circle"></i></button>
        </div>

        <div class="transport-controls">
            <div class="control-item">
                <i class="fas fa-heartbeat"></i>
                <input type="number" id="bpm-input" value="128" onchange="updateBPM(this.value)">
                <span>BPM</span>
            </div>
            
            <div class="control-item">
                <i class="fas fa-clock"></i>
                <select id="time-sig" onchange="updateTimeSig(this.value)">
                    <option value="4">4/4</option>
                    <option value="3">3/4</option>
                </select>
            </div>
        </div>
        
        <button class="fullscreen-toggle" onclick="toggleFullscreen()" title="Full Screen">
            <i class="fas fa-expand"></i> Full Screen
        </button>
    </div>

    <div id="update-banner" class="update-banner hidden">
        <span id="update-text">Update available.</span>
        <button id="update-reload" type="button">Reload</button>
    </div>

    <div class="workspace">
        
        <div class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-header">
                    <span>Patterns</span>
                    <i class="fas fa-plus" onclick="createNewPattern()" title="New Pattern"></i>
                </div>
                <div class="resource-list" id="pattern-list"></div>
            </div>

            <div class="sidebar-section" style="border-top: 1px solid #000;">
                <div class="sidebar-header">
                    <span>Audio Clips</span>
                    <i class="fas fa-folder-open" onclick="document.getElementById('audio-upload').click()" title="Import Audio"></i>
                </div>
                <div class="resource-list" id="audio-list"></div>
            </div>
        </div>

        <div class="playlist-container">
            <div class="playlist-header" id="ruler"></div> 
            
            <div class="playlist-scroll" id="playlist-scroll">
                <div id="playhead"><div class="playhead-triangle"></div></div>
                <div id="playlist-tracks"></div> 
            </div>
        </div>
    </div>

    <div class="channel-rack">
        <div class="rack-header">
            <span id="rack-title">SEQUENCER</span>
            <button onclick="clearCurrentPattern()" style="font-size:10px; padding:2px 8px;">Clear</button>
        </div>
        <div class="rack-scroll" id="rack-rows"></div>
    </div>

    <input type="file" id="audio-upload" accept="audio/*" style="display:none;" onchange="handleAudioUpload(this)">

    <script src="canvasaudio.js"></script>
</body>
</html>
